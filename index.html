<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Pharmacy Dashboard - Stock Management</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-title">
                    <h1><i class="fas fa-pills"></i> Pharmacy Dashboard</h1>
                    <p class="subtitle">Advanced Stock Management System</p>
                </div>
                <div class="header-controls">
                    <button class="btn btn-secondary" id="darkModeToggle" title="Toggle Dark Mode">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="tab-btn active" data-tab="overview">
                <i class="fas fa-chart-line"></i> Overview
            </button>
            <button class="tab-btn" data-tab="inventory">
                <i class="fas fa-boxes"></i> Inventory
            </button>
            <button class="tab-btn" data-tab="add-medicine">
                <i class="fas fa-plus-circle"></i> Add Medicine
            </button>
            <button class="tab-btn" data-tab="sales-history">
                <i class="fas fa-history"></i> Sales History
            </button>
            <button class="tab-btn" data-tab="purchase-orders">
                <i class="fas fa-clipboard-list"></i> Purchase Orders
            </button>
            <button class="tab-btn" data-tab="alerts">
                <i class="fas fa-bell"></i> Alerts
            </button>
            <button class="tab-btn" data-tab="reports">
                <i class="fas fa-file-export"></i> Reports
            </button>
        </nav>

        <!-- Overview Tab -->
        <section id="overview" class="tab-content active">
            <!-- Overview Cards -->
            <div class="cards-grid">
                <div class="card card-primary">
                    <div class="card-header">
                        <i class="fas fa-capsules"></i>
                        <h3>Total Medicines</h3>
                    </div>
                    <p class="card-value" id="totalMedicines">0</p>
                    <span class="card-label">In Stock</span>
                </div>
                <div class="card card-warning">
                    <div class="card-header">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Low Stock Items</h3>
                    </div>
                    <p class="card-value" id="lowStockCount">0</p>
                    <span class="card-label">Needs Reorder</span>
                </div>
                <div class="card card-danger">
                    <div class="card-header">
                        <i class="fas fa-calendar-times"></i>
                        <h3>Expiry Soon</h3>
                    </div>
                    <p class="card-value" id="expirySoonCount">0</p>
                    <span class="card-label">30 Days</span>
                </div>
                <div class="card card-success">
                    <div class="card-header">
                        <i class="fas fa-shopping-cart"></i>
                        <h3>Today's Sales</h3>
                    </div>
                    <p class="card-value" id="todaysSales">₹0</p>
                    <span class="card-label">Revenue</span>
                </div>
                <div class="card card-info">
                    <div class="card-header">
                        <i class="fas fa-chart-pie"></i>
                        <h3>Total Revenue</h3>
                    </div>
                    <p class="card-value" id="totalRevenue">₹0</p>
                    <span class="card-label">All Time</span>
                </div>
                <div class="card card-purple">
                    <div class="card-header">
                        <i class="fas fa-coins"></i>
                        <h3>Inventory Value</h3>
                    </div>
                    <p class="card-value" id="inventoryValue">₹0</p>
                    <span class="card-label">Total Cost</span>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-section">
                <div class="chart-container">
                    <div class="chart-header">
                        <h2><i class="fas fa-bar-chart"></i> Top-Selling Medicines</h2>
                    </div>
                    <canvas id="salesChart"></canvas>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h2><i class="fas fa-line-chart"></i> Revenue Trends (Last 7 Days)</h2>
                    </div>
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>

            <!-- Inventory Summary -->
            <div class="summary-section">
                <div class="summary-card">
                    <h3><i class="fas fa-cube"></i> Inventory Summary</h3>
                    <div class="summary-content">
                        <div class="summary-item">
                            <span>Total Units:</span>
                            <strong id="totalUnits">0</strong>
                        </div>
                        <div class="summary-item">
                            <span>Categories:</span>
                            <strong id="totalCategories">0</strong>
                        </div>
                        <div class="summary-item">
                            <span>Avg Price:</span>
                            <strong id="avgPrice">₹0</strong>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Inventory Tab -->
        <section id="inventory" class="tab-content">
            <div class="section-header">
                <h2><i class="fas fa-boxes"></i> Medicine Inventory</h2>
                <div class="header-actions">
                    <input type="text" id="filterByName" placeholder="Filter by name..." class="filter-input">
                    <select id="filterByCategory" class="filter-input">
                        <option value="">All Categories</option>
                    </select>
                    <select id="filterByManufacturer" class="filter-input">
                        <option value="">All Manufacturers</option>
                    </select>
                    <select id="filterByStatus" class="filter-input">
                        <option value="">All Status</option>
                        <option value="in-stock">In Stock</option>
                        <option value="low">Low Stock</option>
                        <option value="expired">Expired</option>
                    </select>
                </div>
            </div>

            <div class="table-container">
                <table class="inventory-table">
                    <thead>
                        <tr>
                            <th>Medicine Name</th>
                            <th>Batch/Lot #</th>
                            <th>Qty</th>
                            <th>Price (₹)</th>
                            <th>Expiry Date</th>
                            <th>Manufacturer</th>
                            <th>Supplier</th>
                            <th>Category</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="medicineTableBody">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Add Medicine Tab -->
        <section id="add-medicine" class="tab-content">
            <h2><i class="fas fa-plus-circle"></i> Add/Edit Medicine</h2>
            <form id="addMedicineForm" class="form-container">
                <div class="form-section">
                    <h3>Basic Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="medicineName">Medicine Name *</label>
                            <input type="text" id="medicineName" required placeholder="e.g., Paracetamol 500mg">
                        </div>
                        <div class="form-group">
                            <label for="medicineCategory">Category *</label>
                            <input type="text" id="medicineCategory" required placeholder="e.g., Pain Relief">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="medicineManufacturer">Manufacturer *</label>
                            <input type="text" id="medicineManufacturer" required placeholder="e.g., Company Name">
                        </div>
                        <div class="form-group">
                            <label for="medicineSupplier">Supplier *</label>
                            <input type="text" id="medicineSupplier" required placeholder="e.g., Supplier Name">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Stock & Pricing</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="medicineQuantity">Quantity (Units) *</label>
                            <input type="number" id="medicineQuantity" required min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="medicinePrice">Price (₹) *</label>
                            <input type="number" id="medicinePrice" required min="0" step="0.01" placeholder="0.00">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="medicineBatchNo">Batch/Lot Number</label>
                            <input type="text" id="medicineBatchNo" placeholder="e.g., BATCH123456">
                        </div>
                        <div class="form-group">
                            <label for="medicineExpiry">Expiry Date *</label>
                            <input type="date" id="medicineExpiry" required>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Medicine
                    </button>
                    <button type="reset" class="btn btn-secondary">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                </div>
            </form>
        </section>

        <!-- Sales History Tab -->
        <section id="sales-history" class="tab-content">
            <div class="section-header">
                <h2><i class="fas fa-history"></i> Sales History</h2>
                <div class="header-actions">
                    <input type="date" id="filterByDate" class="filter-input">
                    <button class="btn btn-secondary" onclick="exportSalesCSV()">
                        <i class="fas fa-download"></i> Export CSV
                    </button>
                </div>
            </div>

            <div class="table-container">
                <table class="inventory-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Medicine</th>
                            <th>Quantity</th>
                            <th>Price (₹)</th>
                            <th>Total (₹)</th>
                        </tr>
                    </thead>
                    <tbody id="salesHistoryTableBody">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Purchase Orders Tab -->
        <section id="purchase-orders" class="tab-content">
            <div class="section-header">
                <h2><i class="fas fa-clipboard-list"></i> Purchase Orders</h2>
                <button class="btn btn-primary" onclick="switchTab('add-purchase-order')">
                    <i class="fas fa-plus"></i> New Purchase Order
                </button>
            </div>

            <div class="purchase-orders-container">
                <div id="purchaseOrdersList" class="purchase-orders-list">
                </div>
            </div>
        </section>

        <!-- Add Purchase Order Tab -->
        <section id="add-purchase-order" class="tab-content">
            <h2><i class="fas fa-plus-circle"></i> Create Purchase Order</h2>
            <form id="addPurchaseOrderForm" class="form-container">
                <div class="form-section">
                    <h3>Order Details</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="poMedicine">Select Medicine *</label>
                            <select id="poMedicine" required>
                                <option value="">Select a medicine</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="poSupplier">Supplier *</label>
                            <input type="text" id="poSupplier" required placeholder="e.g., ABC Pharma">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="poQuantity">Quantity (Units) *</label>
                            <input type="number" id="poQuantity" required min="1" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="poPrice">Unit Price (₹) *</label>
                            <input type="number" id="poPrice" required min="0" step="0.01" placeholder="0.00">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="poExpectedDate">Expected Delivery Date</label>
                            <input type="date" id="poExpectedDate">
                        </div>
                        <div class="form-group">
                            <label for="poStatus">Status</label>
                            <select id="poStatus">
                                <option value="pending">Pending</option>
                                <option value="ordered">Ordered</option>
                                <option value="in-transit">In Transit</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="poNotes">Notes</label>
                        <textarea id="poNotes" rows="3" placeholder="Order notes..."></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Create Purchase Order
                    </button>
                    <button type="reset" class="btn btn-secondary">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                </div>
            </form>
        </section>

        <!-- Alerts Tab -->
        <section id="alerts" class="tab-content">
            <h2><i class="fas fa-bell"></i> Alerts & Warnings</h2>
            <div id="alertsContainer" class="alerts-container">
            </div>
        </section>

        <!-- Reports Tab -->
        <section id="reports" class="tab-content">
            <h2><i class="fas fa-file-export"></i> Reports & Export</h2>

            <div class="reports-grid">
                <div class="report-card">
                    <h3><i class="fas fa-chart-bar"></i> Inventory Report</h3>
                    <p>Export detailed inventory data with all medicine details</p>
                    <button class="btn btn-primary" onclick="exportInventoryCSV()">
                        <i class="fas fa-download"></i> Export as CSV
                    </button>
                    <button class="btn btn-secondary" onclick="exportInventoryJSON()">
                        <i class="fas fa-download"></i> Export as JSON
                    </button>
                </div>

                <div class="report-card">
                    <h3><i class="fas fa-chart-pie"></i> Profit & Loss</h3>
                    <p>View detailed profit and loss analysis</p>
                    <button class="btn btn-primary" onclick="generateProfitLossReport()">
                        <i class="fas fa-chart-line"></i> Generate Report
                    </button>
                </div>

                <div class="report-card">
                    <h3><i class="fas fa-file-pdf"></i> Print Inventory</h3>
                    <p>Print the complete medicine inventory as PDF</p>
                    <button class="btn btn-primary" onclick="printInventory()">
                        <i class="fas fa-print"></i> Print as PDF
                    </button>
                </div>

                <div class="report-card">
                    <h3><i class="fas fa-database"></i> Data Management</h3>
                    <p>Import/Export or reset all data</p>
                    <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">
                        <i class="fas fa-upload"></i> Import Data
                    </button>
                    <button class="btn btn-secondary" onclick="exportData()">
                        <i class="fas fa-download"></i> Backup Data
                    </button>
                    <button class="btn btn-danger" onclick="resetToSampleData()">
                        <i class="fas fa-redo"></i> Reset to Sample
                    </button>
                    <input type="file" id="importFile" accept=".json" style="display:none;" onchange="importData(this.files[0])">
                </div>
            </div>

            <div class="reports-section">
                <h3><i class="fas fa-list"></i> Profit & Loss Analysis</h3>
                <div id="profitLossReport" class="profit-loss-report">
                </div>
            </div>
        </section>
    </div>

    <!-- Medicine Details Modal -->
    <div id="medicineModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="medicineDetails">
            </div>
        </div>
    </div>

    <!-- Error/Success Notifications -->
    <div id="notificationContainer" class="notification-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
